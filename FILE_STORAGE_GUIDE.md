# 本地文件存储使用指南

## 概述

TodoList应用现在支持两种数据存储模式：
1. **本地文件存储**（推荐）：数据保存在本地JSON文件中
2. **浏览器存储**（备用）：数据保存在浏览器localStorage中

## 本地文件存储的优势

✅ **数据持久化**：数据不会因清除浏览器数据而丢失  
✅ **跨浏览器共享**：同一台电脑上的不同浏览器可以访问相同数据  
✅ **易于备份**：数据文件可以复制、移动、备份  
✅ **版本控制友好**：JSON文件可以加入Git版本控制  
✅ **多设备同步**：可以将数据文件复制到其他设备  

## 浏览器兼容性

本地文件存储功能需要现代浏览器支持，以下浏览器支持：
- Chrome 86+
- Edge 86+
- Opera 72+

**注意**：Firefox和Safari目前不完全支持文件系统访问API

## 使用方法

### 1. 启用文件存储模式

1. 登录应用后，在右上角找到存储模式切换按钮
2. 点击"🌐 浏览器存储"按钮，切换到"💾 文件存储"模式
3. 如果按钮显示为禁用状态，说明当前浏览器不支持文件系统API

### 2. 创建新的数据文件

1. 切换到文件存储模式后，点击"📄 新建文件"按钮
2. 选择保存位置和文件名（建议保存在项目目录下）
3. 系统会自动创建JSON格式的数据文件
4. 创建成功后，当前用户数据会自动保存到新文件中

### 3. 选择现有数据文件

1. 点击"📁 选择文件"按钮
2. 选择之前创建的JSON数据文件
3. 系统会加载文件中的所有用户数据
4. 如果文件中有当前用户的数据，会自动加载

### 4. 数据文件格式

数据文件采用以下JSON结构：

```json
{
  "users": [
    {
      "username": "用户名",
      "password": "密码",
      "createdAt": "创建时间",
      "updatedAt": "更新时间"
    }
  ],
  "topics": {
    "用户名": [
      {
        "id": "专题ID",
        "name": "专题名称",
        "description": "专题描述",
        "createdAt": "创建时间",
        "tasks": [
          {
            "id": "任务ID",
            "name": "任务名称",
            "description": "任务描述",
            "createdAt": "创建时间",
            "todos": [
              {
                "id": "待办ID",
                "title": "待办标题",
                "description": "待办描述",
                "progress": 进度百分比,
                "note": "备注",
                "createdAt": "创建时间"
              }
            ]
          }
        ]
      }
    ]
  }
}
```

## 文件管理建议

### 文件位置
- 建议将数据文件保存在项目目录下
- 可以创建专门的`data`文件夹存放数据文件
- 文件名建议包含日期，如：`todolist_2024_01_01.json`

### 备份策略
- 定期复制数据文件到其他位置
- 可以将数据文件加入Git版本控制
- 重要数据建议多份备份

### 数据迁移
- 将数据文件复制到新设备即可迁移数据
- 支持多用户数据，可以共享一个数据文件
- 导入导出功能仍然可用，支持JSON和Markdown格式

## 故障排除

### 问题1：无法切换到文件存储模式
**原因**：浏览器不支持文件系统访问API  
**解决**：使用Chrome、Edge或Opera浏览器，或继续使用浏览器存储模式

### 问题2：数据文件无法保存
**原因**：文件权限问题或磁盘空间不足  
**解决**：检查文件权限，确保有写入权限，检查磁盘空间

### 问题3：数据文件损坏
**原因**：文件写入过程中程序异常退出  
**解决**：从备份恢复，或使用导入功能重新导入数据

### 问题4：多用户数据冲突
**原因**：多个用户同时编辑同一数据文件  
**解决**：避免同时编辑，或为不同用户创建独立的数据文件

## 安全注意事项

⚠️ **数据文件包含用户密码**：密码以明文形式存储，请妥善保管数据文件  
⚠️ **文件访问权限**：确保数据文件不会被未授权访问  
⚠️ **定期备份**：重要数据请定期备份到安全位置  

## 示例数据文件

项目根目录下的`example-data.json`文件包含了示例数据，可以用来测试文件存储功能。

## 技术支持

如果遇到问题，请：
1. 检查浏览器控制台的错误信息
2. 确认浏览器版本是否支持文件系统API
3. 尝试重新创建数据文件
4. 提交Issue描述具体问题 